<link rel="manifest" href="manifest.json" />

<style>
    form  { display: table;      }
    p     { display: table-row;  }
    label { display: table-cell; }
    input { display: table-cell; }
    .nav-container {
            height: 20%; /* Corrected typo: "300 px" to "300px" */
            width: 100%; /* Ensure the container itself takes full width */
            display: flex; /* Makes this div a flex container */
            justify-content: space-around; /* Distributes items with space around them */
            /* Alternatively, use justify-content: space-between; for items pushed to ends with space between */
            /* Or justify-content: stretch; if you want items to stretch to fill remaining space */
            align-items: stretch; /* Makes children stretch to fill the height of the container */
            overflow: hidden; /* Ensures rounded corners apply to children if they extend */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            margin-top:10px;
        }
    .navbutton {
        width:20%;
        height:15%;
        display: inline-block;
        padding: 10px 20px;
        background-color: #4c66af;
        color: white;
        text-align: center;
        text-decoration: none;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    .navbutton:hover {
        background-color: #4c66af9b;
        color:black
    }
    .fullscreenbutton {
        display:"block";
        width:100%;
        height: 15%;
        padding-top:5px;
        padding-bottom:5px;
        margin: 5px;
        border-radius: 5px;
    }
    .titletxt{
        width: 100%;
        margin-top: 10px;
        text-align: center;
        font-size: x-large;
        display:block;
    }
    .labeltxt{
        font-size:large;
        text-align: left;
    }
.header {
    height: 40px;
    background-color: red;
}

.mainBody {
    background-color: yellow;
    position: absolute;
    top: 40px;
    bottom: 20px;
    width:100%;
    flex-direction: column;
    align-content: space-evenly;
}

.content {
    color:#fff;
}

.footer {
    height: 20px;
    background-color: blue;
    
    position: absolute;
    bottom: 0;
    width:100%;
}
    
</style>
<div class="header">

</div>
<div class="mainBody">
    <!-- <div class="nav-container"> -->
    <a class = "navbutton" >Current Workout</a>
    <a class = "navbutton" href = "Statistics.html" >Statistics</a>
    <a class = "navbutton" href = "History.html">History</a>
    <!-- </div> -->

    <form style="align-items: left;">
        <input class="fullscreenbutton" type="button" onclick="resetSession()" value="Reset Session">
        <hp class="titletxt">Workout Type</p>
        <select id="type"> <!--This field submitted successfully -->
            <option value="hangboard"> Hangboard </option>
            <option value="pinch block"> Pinch Block</option>..........
        </select>
        <label class="labeltxt" id = "changedHeading">Edge Width</p>
        <input id="edge" style="display: block" type="number" list="EdgeWidths" title="Edge">
        <select id="pinch" style="display: none"type="number" list="EdgeWidths" title="Edge">
            <option value="thin-wood">Thin Wood</option>
            <option value="wide-wood">Wide Wood</option>
            <option value="thin-metal">Thin Metal</option>
            <option value="wide-metal">Wide Metal</option>
        </select>
        <label class="labeltxt">Time</p>
        <input id="time" type="number" list="CommonTimes" title="Time">
        <label class="labeltxt">Weight</p>
        <input id="weight" type="number"  title="Weight">
        <input  class="fullscreenbutton" type="button" onclick="addLift()" value="Add lift">
        <input class="fullscreenbutton" type="button" onclick="completeSession()" value="Complete Session">
    </form>
</div>
<script>
    class workout{
        constructor(t, n, lbs){
            this.weight = lbs
            this.id = n
            this.time = t
        }
    }
    class hangboard extends workout{
        constructor(n, t, e ,lbs ){
            super(t, n, lbs)
            this.type = "h"
            this.edge = e
        }
    }
    class pinchblock extends workout{
        constructor(n, t, w, lbs){
            super(t, n, lbs)
            this.type = "p"
            this.width = w
        }
    }
    document.addEventListener('DOMContentLoaded', function() {
    const mySelect = document.getElementById('type');
    const displayHeading = document.getElementById('changedHeading');


    mySelect.addEventListener('change', function() {
        // 3. Get the selected value and text
        const selectedValue = mySelect.value;
        const selectedText = mySelect.options[mySelect.selectedIndex].textContent;


        if (selectedValue === 'hangboard') {
            displayHeading.textContent = "Edge Width";
            document.getElementById("edge").style.display = 'block';
            document.getElementById("pinch").style.display = 'none';
        } else {
            displayHeading.textContent = "Pinch Width";
            document.getElementById("edge").style.display = 'none';
            document.getElementById("pinch").style.display = 'block';

        }
    });

        // Optional: Set initial state if needed
        // You might want to call the update logic once when the page loads
        // to reflect the initial state of the select element.
        // However, in this case, our default option is already handled.
    });
    function onload(){
        document.getElementById('changedHeading').textContent = "Edge Width";
        document.getElementById("edge").style.display = 'block';
        document.getElementById("pinch").style.display = 'none';
    }
    function resetSession(){
        window.localStorage.workout = JSON.stringify({thisSession: [], num: 0})
    }
    function addLift() {

        let localData = JSON.parse(window.localStorage.workout)
        console.log(localData)
        let edge = parseInt(document.getElementById("edge").value)
        let pinch = document.getElementById("pinch").selectedIndex
        let time = parseInt(document.getElementById("time").value)
        let weight = parseInt(document.getElementById("weight").value)
        console.log(window.localStorage.workout.num)
        
        if (document.getElementById('type').selectedIndex == 0) {
            console.log("hang")
            localData.thisSession.push(new hangboard(localData.num, time, edge, weight))
            localData.num++;
        }else{
            console.log("pinch")
            localData.thisSession.push(new pinchblock(localData.num,time, pinch, weight))
            localData.num++;
        }

        window.localStorage.workout = JSON.stringify(localData)
    }
    function completeSession() {
        let localData = JSON.parse(window.localStorage.sessions)
        console.log(localData)
        let workout = JSON.parse(window.localStorage.workout)
        console.log(workout.thisSession)
        let currentdate = new Date();
        workout.thisSession.unshift(currentdate.getMonth()+"/" +currentdate.getDate()+"/"+currentdate.getFullYear());
        console.log(workout.thisSession)
        localData.sessions.push(workout.thisSession) 
        window.localStorage.sessions = JSON.stringify(localData)
        resetSession()
        
    }
    function wipeData(){
        localStorage.clear()
        localStorage.sessions = JSON.stringify({sessions: []})
        resetSession()
    }
</script>

<datalist id="EdgeWidths">
    <option value="8">
    <option value="10">
    <option value="15">
</datalist>
<datalist id="CommonTimes">
    <option value="5">
    <option value="8">
    <option value="10">
</datalist>